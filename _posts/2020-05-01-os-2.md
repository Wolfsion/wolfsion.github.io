---
layout: post
title:  "操作系统进程管理"
date:   2020-05-01
excerpt: "进程管理综述"
tags: [操作系统]
comments: true
---
# 进程管理

## 进程概述

+ **定义**：一个具有一定独立功能的程序关于某个数据集合的**一次运行活动**，是系统进行**资源分配和调度**运行的**基本单位**

+ 表示：进程控制块PCB

+ 进程空间

  + 栈
  + 堆
  + 数据
  + 文本

  ![image-20210721165759300](..\assets\img\os-2-1.png)

+ 进程状态：

  + new
  + ready
  + running
  + waiting
  + terminated

  ![image-20210721165732086](..\assets\img\os-2-2.png)

+ 进程操作：

  + 进程生命周期管理（僵尸进程与孤儿进程）
  + 进程调度
  + 进程同步
  + 进程互斥
  + 进程间通信



## 进程调度

+ **定义**：对所有处于就绪状态的进程，按一定的原则选择一个进程准备参与运行
+ 调度场景：
  + running -> waiting
  + running -> ready
  + waiting -> ready
  + terminated
+ 分类
  + 抢占式调度
  + 非抢占式调度
+ 评估
  + CPU使用率
  + 吞吐量
  + 周转时间、等待时间、响应时间
+ 调度算法
  + FCFS
  + SJF
  + 优先级调度
  + 轮转调度
  + 多级队列调度
  + 多级反馈队列调度
+ 上下文切换*
+ 多处理器调度*



## 进程同步

+ **定义**：两个以上进程基于某个条件来协调它们的活动
+ **本质**：解决进程间**松散的协作**关系（主观为之），通过控制信息（信号量）
+ 解决临界区问题的3个关键点
  + 互斥：关键区有且仅有一个进程访问
  + 进步：一个进程可以进入正常工作
  + 有限等待：一个进程进入后，另一个进程在有限时间后也可进入
+ 关键机制
  + 信号量
  + 互斥锁
  + 两者一般结合使用
+ 信号量
  + 原子操作：不能被中断的连续操作
  + 竞争条件：两个或多个进程读写某些共享数据
  + 分类
    + 二进制信号量
    + 计数信号量
  + 操作(PV原语)
    + wait()
    + signal()
  + 消除忙等待的写法*
+ 同步方式
  + Peterson‘s
  + 互斥锁
  + 信号量
+ 进阶问题
  + 死锁
  + 饥饿
  + 优先级反转
+ 经典实例
  + 有界缓冲问题
  + 读者-写者问题
  + 哲学家就餐问题



## 进程互斥

+ **定义**：指若干个进程要使用同一共享资源时，任何时刻最多允许一个进程去使用，其他要使用该资源的进程必须等待，直到占有资源的进程释放该资源。
+ **本质**：解决进程间竞争关系（客观要求）
+ 互斥锁
  + 应用：解决进程间互斥问题



## 死锁

+ 系统模型：有限资源的集合

+ **定义**：多个进程在运行过程中因争夺资源而造成的一种僵局，当进程处于这种僵持状态时，若无外力作用，它们都将无法再向前推进。

+ 基本概念

  + 资源
    + 物理资源
    + 逻辑资源
  + 进程对资源的操作
    + 请求
    + 使用
    + 释放

+ 死锁场景

  + 申请同种资源
  + 申请不同资源
  + IPC
  + 单个进程、线程自身死锁

+ 发生死锁的4个必要条件

  + 互斥：资源唯一持有才可正常运行
  + 占用并等待：进程获得占用资源，并等待预期获得其他资源
  + 非抢占：进程不对已被占有的资源强制获取
  + 循环等待：进程资源占有申请循环链

+ 描述：

  + 资源分配图

    + 资源结点
    + 进程结点
    + 申请边
    + 分配边

  + 应用：判定死锁发生

    `由资源分配图判断安全态和非安全态，非安全态不一定会导致死锁，而安全态一定不会导致死锁`

+ 解决措施

  + 死锁预防：消除4个死锁发生的必要条件之一
  + 死锁避免：动态检测然后分配
    + 银行家算法，使用了资源分配图*
  + 死锁检测：基于等待图检测当前是否发生死锁
  + 死锁恢复：可人工干预或终止进程或抢占资源
  + 忽视



## 进程间通信

+ **本质**：解决进程间**紧密的协作**关系，交换大量信息
+ 分类
  + 共享内存
  + 消息传递
+ 共享内存
  + 生产者-消费者问题
  + 缓冲区容量
+ 消息传递
  + 概述：类似邮箱的收发机制
  + 关键概念
    + **同步与阻塞**：区分描述接收者的状态
  + 分类
    + 直接通信
    + 间接通信
  + 管道
    + 读端与写端
    + 匿名管道与命名管道



## 线程

+ **定义**：调度运算的最基本单位。
+ **特性**：线程被包含于进程中，是进程中实际运作单位，进程中的单一控制执行流，本身不占有系统资源，只占有少量需要的资源。
+ 持有资源
  + PC程序计数器
  + 栈
  + 寄存器组
+ 提出场景：进程可分割为多个独立任务执行
+ 优势：
  + 快速响应
  + 经济
  + 线程间易于共享通信
  + 可扩展
+ 分类
  + 用户线程
  + 内核线程
  + 映射关系
+ 多核编程
+ 线程库*
  + 线程池*
+ 线程调度*



## 衍生技术

+ 管程
+ 协程
